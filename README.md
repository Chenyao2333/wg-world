# wg-mesh

A mesh network configurator based on [Wireguard](https://www.wireguard.com/).

## Usage

`wg-mesh` configurator only works on Linux. Clone this project and run `thirdpary.py` to install the necessary dependencies. Note `thirdpart.py` only works on Ubuntu and other Debian-based systems, try to port it if you are running on other systems.

See `example.py` for the example configuration. In `example.py`, it configures two router nodes `bj` and `hk`, and a few clients. `wg-mesh` is based on Wireguard to build the P2P tunnel. So it needs to read and manage the Wireguard credentials. Run `./exmaple.py genkey all` to generate keys, saved to `keys` directory, for all hosts.

Run `./exmaple.py mock` to generate a local mock network based on [network namespaces](https://blog.scottlowe.org/2013/09/04/introducing-linux-network-namespaces/). You can explore it by using `sudo ip netns HOST_NAME CMD` to run commands in the mock network.

To set up the mesh network in the real environment, you have to sync the keys generated before to all hosts and then run `./example.py up HOST_NAME` on the corresponding host. For the non-Linux client which cannot be configured by this script, it can be natively configured by Wrieguard using the configuration generated by `./example.py gen-client-conf HOST_NAME`.
